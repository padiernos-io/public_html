services:
  plugin.manager.pattern_token_dependency_provider:
    class: Drupal\pathauto_update\PatternTokenDependencyProviderManager
    parent: default_plugin_manager

  pathauto_update.path_alias_dependency.resolver:
    class: Drupal\pathauto_update\PathAliasDependencyResolver
    arguments:
      - '@token'
      - '@token.entity_mapper'
      - '@pathauto.alias_cleaner'
      - '@pathauto.generator'
      - '@plugin.manager.pattern_token_dependency_provider'

  pathauto_update.path_alias_dependency.repository:
    class: Drupal\pathauto_update\PathAliasDependencyRepository
    arguments:
      - '@entity_type.manager'
      - '@database'
      - '@queue'
      - '@url_entity.extractor'

  pathauto_update.path_alias_dependency_delete.subscriber:
    class: Drupal\pathauto_update\EventSubscriber\DependencyDeleteSubscriber
    arguments:
      - '@database'
      - '@pathauto_update.path_alias_dependency.repository'
    tags: [{ name: event_subscriber }]

  pathauto_update.path_alias_dependency_update.subscriber:
    class: Drupal\pathauto_update\EventSubscriber\DependencyUpdateSubscriber
    arguments:
      - '@pathauto_update.path_alias_dependency.repository'
    tags: [{ name: event_subscriber }]

  pathauto_update.menu_link_content.subscriber:
    class: Drupal\pathauto_update\EventSubscriber\MenuLinkContentSubscriber
    arguments:
      - '@entity_type.manager'
      - '@pathauto_update.path_alias_dependency.resolver'
      - '@pathauto_update.path_alias_dependency.repository'
      - '@url_entity.extractor'

  pathauto_update.path_alias_update.subscriber:
    class: Drupal\pathauto_update\EventSubscriber\PathAliasUpdateSubscriber
    arguments:
      - '@pathauto_update.path_alias_dependency.resolver'
      - '@pathauto_update.path_alias_dependency.repository'
      - '@url_entity.extractor'
